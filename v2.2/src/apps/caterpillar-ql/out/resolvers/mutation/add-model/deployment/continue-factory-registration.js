"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _debug2 = _interopRequireDefault(require("debug"));

var _createWorklistInstances = _interopRequireDefault(require("./create-worklist-instances"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

var debug = (0, _debug2["default"])('caterpillarql:add-model:continue-factory-registration');

var continueFactoryRegistration = function continueFactoryRegistration(web3, registryContract, currentIndex, sortedElements, outputContracts, contractF, modelInfo, registerFactory) {
  return web3.eth.personal.getAccounts().then(function (accounts) {
    return registryContract.methods.registerFactory(web3.utils.fromAscii(sortedElements[currentIndex].bundleId), contractF.address).send({
      from: accounts[0],
      gas: 4700000
    }).then(function (result1) {
      debug("".concat(sortedElements[currentIndex].nodeName, "_Factory registered SUCCESSFULLY in Process Registry"));
      debug('....................................................................');

      if (currentIndex + 1 < sortedElements.length) {
        return registerFactory(web3, registryContract, currentIndex + 1, sortedElements, outputContracts, modelInfo);
      } else {
        debug('....................................................................');
        debug('DEPLOYONG WORKLIST CONTRACTS AND UPDATING PROCESS REGISTRY ...');
        return (0, _createWorklistInstances["default"])(web3, registryContract, 0, sortedElements, outputContracts, modelInfo);
      }
    });
  });
};

var _default = continueFactoryRegistration;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL2FwcC9yZXNvbHZlcnMvbXV0YXRpb24vYWRkLW1vZGVsL2RlcGxveW1lbnQvY29udGludWUtZmFjdG9yeS1yZWdpc3RyYXRpb24udHMiXSwibmFtZXMiOlsiZGVidWciLCJjb250aW51ZUZhY3RvcnlSZWdpc3RyYXRpb24iLCJ3ZWIzIiwicmVnaXN0cnlDb250cmFjdCIsImN1cnJlbnRJbmRleCIsInNvcnRlZEVsZW1lbnRzIiwib3V0cHV0Q29udHJhY3RzIiwiY29udHJhY3RGIiwibW9kZWxJbmZvIiwicmVnaXN0ZXJGYWN0b3J5IiwiZXRoIiwicGVyc29uYWwiLCJnZXRBY2NvdW50cyIsInRoZW4iLCJhY2NvdW50cyIsIm1ldGhvZHMiLCJ1dGlscyIsImZyb21Bc2NpaSIsImJ1bmRsZUlkIiwiYWRkcmVzcyIsInNlbmQiLCJmcm9tIiwiZ2FzIiwicmVzdWx0MSIsIm5vZGVOYW1lIiwibGVuZ3RoIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBQ0E7Ozs7QUFFQSxJQUFNQSxLQUFLLEdBQUcsd0JBQU8sdURBQVAsQ0FBZDs7QUFFQSxJQUFNQywyQkFBMkIsR0FBRyxTQUE5QkEsMkJBQThCLENBQ2xDQyxJQURrQyxFQUVsQ0MsZ0JBRmtDLEVBR2xDQyxZQUhrQyxFQUlsQ0MsY0FKa0MsRUFLbENDLGVBTGtDLEVBTWxDQyxTQU5rQyxFQU9sQ0MsU0FQa0MsRUFRbENDLGVBUmtDLEVBUy9CO0FBQ0gsU0FBT1AsSUFBSSxDQUFDUSxHQUFMLENBQVNDLFFBQVQsQ0FBa0JDLFdBQWxCLEdBQ0pDLElBREksQ0FFSCxVQUFBQyxRQUFRO0FBQUEsV0FDTlgsZ0JBQWdCLENBQ2JZLE9BREgsQ0FFR04sZUFGSCxDQUdJUCxJQUFJLENBQUNjLEtBQUwsQ0FBV0MsU0FBWCxDQUFxQlosY0FBYyxDQUFDRCxZQUFELENBQWQsQ0FBNkJjLFFBQWxELENBSEosRUFJSVgsU0FBUyxDQUFDWSxPQUpkLEVBTUdDLElBTkgsQ0FPSTtBQUNFQyxNQUFBQSxJQUFJLEVBQUVQLFFBQVEsQ0FBQyxDQUFELENBRGhCO0FBRUVRLE1BQUFBLEdBQUcsRUFBRTtBQUZQLEtBUEosRUFZR1QsSUFaSCxDQWFJLFVBQUNVLE9BQUQsRUFBYTtBQUNUdkIsTUFBQUEsS0FBSyxXQUFJSyxjQUFjLENBQUNELFlBQUQsQ0FBZCxDQUE2Qm9CLFFBQWpDLDBEQUFMO0FBQ0F4QixNQUFBQSxLQUFLLENBQUMsc0VBQUQsQ0FBTDs7QUFDQSxVQUFJSSxZQUFZLEdBQUcsQ0FBZixHQUFtQkMsY0FBYyxDQUFDb0IsTUFBdEMsRUFBOEM7QUFDMUMsZUFBT2hCLGVBQWUsQ0FDcEJQLElBRG9CLEVBRXBCQyxnQkFGb0IsRUFHcEJDLFlBQVksR0FBRyxDQUhLLEVBSXBCQyxjQUpvQixFQUtwQkMsZUFMb0IsRUFNcEJFLFNBTm9CLENBQXRCO0FBT0gsT0FSRCxNQVFPO0FBQ0hSLFFBQUFBLEtBQUssQ0FBQyxzRUFBRCxDQUFMO0FBQ0FBLFFBQUFBLEtBQUssQ0FBQyxnRUFBRCxDQUFMO0FBQ0EsZUFBTyx5Q0FDTEUsSUFESyxFQUVMQyxnQkFGSyxFQUdMLENBSEssRUFJTEUsY0FKSyxFQUtMQyxlQUxLLEVBTUxFLFNBTkssQ0FBUDtBQVFIO0FBQ0osS0FwQ0wsQ0FETTtBQUFBLEdBRkwsQ0FBUDtBQXlDRCxDQW5ERDs7ZUFxRGVQLDJCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IF9kZWJ1ZyBmcm9tICdkZWJ1ZydcbmltcG9ydCBjcmVhdGVXb3JrbGlzdEluc3RhbmNlcyBmcm9tICcuL2NyZWF0ZS13b3JrbGlzdC1pbnN0YW5jZXMnXG5cbmNvbnN0IGRlYnVnID0gX2RlYnVnKCdjYXRlcnBpbGxhcnFsOmFkZC1tb2RlbDpjb250aW51ZS1mYWN0b3J5LXJlZ2lzdHJhdGlvbicpXG5cbmNvbnN0IGNvbnRpbnVlRmFjdG9yeVJlZ2lzdHJhdGlvbiA9IChcbiAgd2ViMyxcbiAgcmVnaXN0cnlDb250cmFjdCxcbiAgY3VycmVudEluZGV4LFxuICBzb3J0ZWRFbGVtZW50cyxcbiAgb3V0cHV0Q29udHJhY3RzLFxuICBjb250cmFjdEYsXG4gIG1vZGVsSW5mbyxcbiAgcmVnaXN0ZXJGYWN0b3J5LFxuKSA9PiB7XG4gIHJldHVybiB3ZWIzLmV0aC5wZXJzb25hbC5nZXRBY2NvdW50cygpXG4gICAgLnRoZW4oXG4gICAgICBhY2NvdW50cyA9PlxuICAgICAgICByZWdpc3RyeUNvbnRyYWN0XG4gICAgICAgICAgLm1ldGhvZHNcbiAgICAgICAgICAucmVnaXN0ZXJGYWN0b3J5KFxuICAgICAgICAgICAgd2ViMy51dGlscy5mcm9tQXNjaWkoc29ydGVkRWxlbWVudHNbY3VycmVudEluZGV4XS5idW5kbGVJZCksXG4gICAgICAgICAgICBjb250cmFjdEYuYWRkcmVzcyxcbiAgICAgICAgICApXG4gICAgICAgICAgLnNlbmQoXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGZyb206IGFjY291bnRzWzBdLFxuICAgICAgICAgICAgICBnYXM6IDQ3MDAwMDBcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgKVxuICAgICAgICAgIC50aGVuKFxuICAgICAgICAgICAgKHJlc3VsdDEpID0+IHtcbiAgICAgICAgICAgICAgICBkZWJ1ZyhgJHtzb3J0ZWRFbGVtZW50c1tjdXJyZW50SW5kZXhdLm5vZGVOYW1lfV9GYWN0b3J5IHJlZ2lzdGVyZWQgU1VDQ0VTU0ZVTExZIGluIFByb2Nlc3MgUmVnaXN0cnlgKTtcbiAgICAgICAgICAgICAgICBkZWJ1ZygnLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4nKTtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudEluZGV4ICsgMSA8IHNvcnRlZEVsZW1lbnRzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVnaXN0ZXJGYWN0b3J5KFxuICAgICAgICAgICAgICAgICAgICAgIHdlYjMsXG4gICAgICAgICAgICAgICAgICAgICAgcmVnaXN0cnlDb250cmFjdCxcbiAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50SW5kZXggKyAxLFxuICAgICAgICAgICAgICAgICAgICAgIHNvcnRlZEVsZW1lbnRzLFxuICAgICAgICAgICAgICAgICAgICAgIG91dHB1dENvbnRyYWN0cyxcbiAgICAgICAgICAgICAgICAgICAgICBtb2RlbEluZm8pXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZGVidWcoJy4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uJyk7XG4gICAgICAgICAgICAgICAgICAgIGRlYnVnKCdERVBMT1lPTkcgV09SS0xJU1QgQ09OVFJBQ1RTIEFORCBVUERBVElORyBQUk9DRVNTIFJFR0lTVFJZIC4uLicpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY3JlYXRlV29ya2xpc3RJbnN0YW5jZXMoXG4gICAgICAgICAgICAgICAgICAgICAgd2ViMyxcbiAgICAgICAgICAgICAgICAgICAgICByZWdpc3RyeUNvbnRyYWN0LFxuICAgICAgICAgICAgICAgICAgICAgIDAsXG4gICAgICAgICAgICAgICAgICAgICAgc29ydGVkRWxlbWVudHMsXG4gICAgICAgICAgICAgICAgICAgICAgb3V0cHV0Q29udHJhY3RzLFxuICAgICAgICAgICAgICAgICAgICAgIG1vZGVsSW5mbyxcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICApXG59O1xuXG5leHBvcnQgZGVmYXVsdCBjb250aW51ZUZhY3RvcnlSZWdpc3RyYXRpb25cbiJdfQ==